-----------------------------------------------------------------------------------------------------------------------------------------
-- VRP
-----------------------------------------------------------------------------------------------------------------------------------------
local Tunnel = module("vrp","lib/Tunnel")
local Proxy = module("vrp","lib/Proxy")
vRP = Proxy.getInterface("vRP")
-----------------------------------------------------------------------------------------------------------------------------------------
-- CONEXÃO
-----------------------------------------------------------------------------------------------------------------------------------------
src = {}
Tunnel.bindInterface("vrp_postit",src)
vSERVER = Tunnel.getInterface("vrp_postit")
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARIÁVEIS
-----------------------------------------------------------------------------------------------------------------------------------------
local postits = {}
-----------------------------------------------------------------------------------------------------------------------------------------
-- REMOVEEVIDENCES
-----------------------------------------------------------------------------------------------------------------------------------------
function src.removePostits(id)
	if postits[id] ~= nil then
		postits[id] = nil
	end
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- EVIDENCESPLAYERS
-----------------------------------------------------------------------------------------------------------------------------------------
function src.postitsPlayers(id,marker)
	postits[id] = marker
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- EVIDENCES:MARKERS
-----------------------------------------------------------------------------------------------------------------------------------------
Citizen.CreateThread(function()
	while true do
		Citizen.Wait(5)
		local ped = PlayerPedId()
		local x,y,z = table.unpack(GetEntityCoords(ped))
		for k,v in pairs(postits) do
			if Vdist(v.x,v.y,v.z,x,y,z) <= 10 then
				DrawText3Ds(v.x,v.y,v.z-0.80,"~w~"..string.upper(v.text))
				if IsControlJustPressed(1,38) then
					vSERVER.pickupPostits(k)
				end
			end
		end
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- DRAWTEXT3D
-----------------------------------------------------------------------------------------------------------------------------------------
function DrawText3Ds(x,y,z,text)
	local onScreen,_x,_y = World3dToScreen2d(x,y,z)
	SetTextFont(4)
	SetTextScale(0.35,0.35)
	SetTextColour(255,255,255,150)
	SetTextEntry("STRING")
	SetTextCentre(1)
	AddTextComponentString(text)
	DrawText(_x,_y)
	local factor = (string.len(text))/300
	DrawRect(_x,_y+0.0125,0.01+factor,0.03,0,0,0,80)
end